var V=Object.defineProperty,q=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var b=(e,u,t)=>u in e?V(e,u,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[u]=t,w=(e,u)=>{for(var t in u||(u={}))L.call(u,t)&&b(e,t,u[t]);if(B)for(var t of B(u))O.call(u,t)&&b(e,t,u[t]);return e},k=(e,u)=>q(e,j(u));var f=(e,u,t)=>new Promise((l,o)=>{var r=n=>{try{c(t.next(n))}catch(i){o(i)}},p=n=>{try{c(t.throw(n))}catch(i){o(i)}},c=n=>n.done?l(n.value):Promise.resolve(n.value).then(r,p);c((t=t.apply(e,u)).next())});import{bT as $,D as z,a as N,s as E,k as s,f as G,o as y,h as v,n as m,y as g,F as A,e5 as C,z as S,j as W,ay as H}from"./index.897eff97.js";import{I as J}from"./index.86d0d66d.js";import{u as K}from"./index.9a8bde03.js";import{B as Q}from"./BasicForm.c9112e09.js";import{u as X}from"./useForm.68d81aa3.js";import{S as Y}from"./index.65a3c605.js";import{u as Z}from"./useComponentRegister.d1d14297.js";import{T as ee}from"./index.0754d235.js";import{s as te}from"./article.23bb38cc.js";import{b as ue,B as ae}from"./index.98fb7ffc.js";import{l as D,i as se,_ as oe}from"./PictureDrawer.b4123ec3.js";Z("Tinymce",ee);const Ee=[{title:"\u5E8F\u53F7",dataIndex:"id",width:200},{title:"\u6807\u9898",dataIndex:"title",width:200},{title:"\u7F29\u7565\u56FE",dataIndex:"img",width:180},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_at",width:180},{title:"\u9690\u85CF",dataIndex:"is_hidden",width:180,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),$(Y,{checked:e.is_hidden,loading:e.pendingStatus,onChange(u){e.pendingStatus=!0;const t=!!u,{createMessage:l}=z();te(e.id,{field:"is_hidden"}).then(o=>{o?(e.is_hidden=t,l.success("\u5DF2\u6210\u529F\u4FEE\u6539\u6587\u7AE0\u72B6\u6001")):l.success("\u4FEE\u6539\u6587\u7AE0\u72B6\u6001\u5931\u8D25")}).catch(()=>{l.error("\u4FEE\u6539\u6587\u7AE0\u72B6\u6001\u5931\u8D25")}).finally(()=>{e.pendingStatus=!1})}}))}],ye=[{field:"key_word",label:"\u540D\u79F0",component:"Input",colProps:{span:8}}],ne=[{field:"title",label:"\u6807\u9898",required:!0,component:"Input"},{field:"type",label:"\u7C7B\u578B",required:!0,component:"Select",componentProps:{options:[{label:"\u72EC\u7ACB\u6587\u7AE0",value:1,key:1},{label:"\u5C0F\u7A0B\u5E8F\u8DF3\u8F6C",value:2,key:2},{label:"\u516C\u544A",value:3,key:3},{label:"\u6D3B\u52A8",value:4,key:4},{label:"\u4E2A\u4EBA\u4E2D\u5FC3",value:5,key:5}]},defaultValue:1},{field:"img_id",label:"\u7F29\u7565\u56FE",required:!0,slot:"picDrawer",component:"Input"},{field:"content",label:"\u5185\u5BB9",required:!0,component:"Tinymce",componentProps:{showImageUpload:!1},defaultValue:""}],le=N({__name:"ArticleModal",emits:["success","register"],setup(e,{emit:u}){const[t,{openDrawer:l}]=K(),o=E(!0),r=E([]),p=E(""),[c,{resetFields:n,setFieldsValue:i,validate:I}]=X({labelWidth:90,baseColProps:{span:24},schemas:ne,showActionButtonGroup:!1}),[R,{setModalProps:h,closeModal:M}]=ue(a=>f(this,null,function*(){n(),h({confirmLoading:!1}),o.value=!!(a!=null&&a.isUpdate),r.value=(yield D()).items,s(o)&&(p.value=a.record.id,i(w({},a.record)))})),x=G(()=>s(o)?"\u7F16\u8F91\u6587\u7AE0":"\u65B0\u589E\u6587\u7AE0");function P(){return f(this,null,function*(){r.value=(yield D()).items})}function T({ids:a,items:d}){i({img_id:(a==null?void 0:a.length)>0?a[0]:null,img:(d==null?void 0:d.length)>0?d[0]:null})}function U(){return f(this,null,function*(){try{const a=yield I();h({confirmLoading:!0}),M(),u("success",{isUpdate:s(o),values:k(w({},a),{id:s(o)?p.value:void 0})})}finally{h({confirmLoading:!1})}})}return(a,d)=>(y(),v(A,null,[m(s(ae),H(a.$attrs,{onRegister:s(R),showFooter:"",title:s(x),width:"500px",onOk:U}),{default:g(()=>[m(s(Q),{onRegister:s(c)},{picDrawer:g(({model:F,field:_})=>[F[_]>0?(y(),v(A,{key:0},[m(s(J),{src:s(se)(F[_]),preview:!1,width:80},null,8,["src"]),m(C,{onClick:()=>F[_]=0},{default:g(()=>[S("\u5220\u9664")]),_:2},1032,["onClick"])],64)):(y(),W(C,{key:1,onClick:s(l)},{default:g(()=>[S("\u9009\u62E9\u56FE\u7247")]),_:1},8,["onClick"]))]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]),m(oe,{images:r.value,onRegister:s(t),onReload:P,onSuccess:T},null,8,["images","onRegister"])],64))}});var Be=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{Be as A,le as _,Ee as c,ye as s};
