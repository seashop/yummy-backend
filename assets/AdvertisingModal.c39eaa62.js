var U=Object.defineProperty,$=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var D=(e,t,a)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,h=(e,t)=>{for(var a in t||(t={}))N.call(t,a)&&D(e,a,t[a]);if(A)for(var a of A(t))O.call(t,a)&&D(e,a,t[a]);return e},E=(e,t)=>$(e,L(t));var p=(e,t,a)=>new Promise((_,o)=>{var i=u=>{try{s(a.next(u))}catch(l){o(l)}},m=u=>{try{s(a.throw(u))}catch(l){o(l)}},s=u=>u.done?_(u.value):Promise.resolve(u.value).then(i,m);s((a=a.apply(e,t)).next())});import{d$ as f,a as T,s as y,k as r,f as z,o as v,h as C,n as d,y as F,F as k,e5 as I,z as P,j as G,ay as H}from"./index.897eff97.js";import{I as W}from"./index.86d0d66d.js";import{u as J}from"./index.9a8bde03.js";import{B as K}from"./BasicForm.c9112e09.js";import{u as Q}from"./useForm.68d81aa3.js";import{l as X}from"./article.23bb38cc.js";import{b as Y,B as Z}from"./index.98fb7ffc.js";import{l as S,i as ee,_ as te}from"./PictureDrawer.b4123ec3.js";const ae=e=>f.get({url:"/banner/get_all_banner",params:e}),Fe=e=>f.get({url:"/banner/admin/banner_all_item",params:e}),fe=e=>f.post({url:"/banner/admin/add_banner",data:e}),_e=e=>f.post({url:"/banner/admin/edit_banner",data:e}),ge=[{title:"\u5E8F\u53F7",dataIndex:"id",width:200},{title:"\u6392\u5E8F",dataIndex:"sort",edit:!0,editable:!0,editComponent:"InputNumber",editComponentProps:()=>({min:0}),width:200},{title:"\u540D\u79F0",dataIndex:"key_word",width:200},{title:"\u5E7F\u544A\u4F4D",dataIndex:"banner_id",format:(e,t)=>t==null?void 0:t.banner.name,width:200},{title:"\u8DF3\u8F6C\u5230",dataIndex:"type",format:(e,t)=>{switch(t.type){case"no_jump":return"\u4E0D\u8DF3\u8F6C";case"article":return"\u6587\u7AE0"}},width:200},{title:"\u7F29\u7565\u56FE",dataIndex:"img",width:180}],be=[{field:"key_word",label:"\u540D\u79F0",component:"Input",colProps:{span:8}}],ne=[{field:"key_word",label:"\u5E7F\u544A\u540D\u79F0",required:!0,component:"Input"},{field:"banner_id",label:"\u9009\u62E9\u5E7F\u544A\u4F4D",required:!0,component:"ApiSelect",componentProps:{api:ae,resultField:"items",params:{withRoot:!0},labelField:"name",valueField:"id"},defaultValue:1},{field:"type",label:"\u8DF3\u8F6C\u5230",required:!0,component:"Select",componentProps:{options:[{label:"\u4E0D\u8DF3\u8F6C",value:"no_jump",key:"no_jump"},{label:"\u6587\u7AE0",value:"article",key:"article"}]},defaultValue:"no_jump"},{field:"jump_id",label:"\u8DF3\u8F6C\u9009\u9879",required:({values:e})=>e.type!=="no_jump",ifShow:({values:e})=>e.type!=="no_jump",component:"ApiSelect",componentProps:{api:X,resultField:"items",labelField:"title",valueField:"id"}},{field:"img_id",label:"\u5E7F\u544A\u56FE\u7247",required:!0,slot:"picDrawer",component:"Input"}],re=T({__name:"AdvertisingModal",emits:["success","register"],setup(e,{emit:t}){const[a,{openDrawer:_}]=J(),o=y(!0),i=y([]),m=y(""),[s,{resetFields:u,setFieldsValue:l,validate:j}]=Q({labelWidth:90,baseColProps:{span:24},schemas:ne,showActionButtonGroup:!1}),[x,{setModalProps:g,closeModal:B}]=Y(n=>p(this,null,function*(){u(),g({confirmLoading:!1}),o.value=!!(n!=null&&n.isUpdate),i.value=(yield S()).items,r(o)&&(m.value=n.record.id,l(h({},n.record)))})),R=z(()=>r(o)?"\u7F16\u8F91\u5E7F\u544A":"\u65B0\u589E\u5E7F\u544A");function M(){return p(this,null,function*(){i.value=(yield S()).items})}function q({ids:n,items:c}){l({img_id:(n==null?void 0:n.length)>0?n[0]:null,img:(c==null?void 0:c.length)>0?c[0]:null})}function V(){return p(this,null,function*(){try{const n=yield j();g({confirmLoading:!0}),B(),t("success",{isUpdate:r(o),values:E(h({},n),{id:r(o)?m.value:void 0})})}finally{g({confirmLoading:!1})}})}return(n,c)=>(v(),C(k,null,[d(r(Z),H(n.$attrs,{onRegister:r(x),showFooter:"",title:r(R),width:"500px",onOk:V}),{default:F(()=>[d(r(K),{onRegister:r(s)},{picDrawer:F(({model:b,field:w})=>[b[w]>0?(v(),C(k,{key:0},[d(r(W),{src:r(ee)(b[w]),preview:!1},null,8,["src"]),d(I,{onClick:()=>b[w]=0},{default:F(()=>[P("\u5220\u9664")]),_:2},1032,["onClick"])],64)):(v(),G(I,{key:1,onClick:r(_)},{default:F(()=>[P("\u9009\u62E9\u56FE\u7247")]),_:1},8,["onClick"]))]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]),d(te,{images:i.value,onRegister:r(a),onReload:M,onSuccess:q},null,8,["images","onRegister"])],64))}});var we=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{we as A,re as _,fe as a,ge as c,Fe as l,be as s,_e as u};
