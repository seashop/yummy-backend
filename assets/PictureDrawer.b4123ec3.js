var I=Object.defineProperty;var U=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var E=(e,t,a)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,w=(e,t)=>{for(var a in t||(t={}))M.call(t,a)&&E(e,a,t[a]);if(U)for(var a of U(t))V.call(t,a)&&E(e,a,t[a]);return e};var v=(e,t,a)=>new Promise((l,u)=>{var r=i=>{try{p(a.next(i))}catch(g){u(g)}},f=i=>{try{p(a.throw(i))}catch(g){u(g)}},p=i=>i.done?l(i.value):Promise.resolve(i.value).then(r,f);p((a=a.apply(e,t)).next())});import{n as c,b1 as A,u as $,e0 as L,d$ as x,a as T,ef as j,v as z,o as y,h as _,aB as H,y as m,k as n,B as K,z as G,i as Z,F as P,aA as q,j as J,q as Q,ay as W,D as X}from"./index.897eff97.js";import{I as Y}from"./index.86d0d66d.js";import{T as C}from"./index.6360dd90.js";import{U as ee}from"./index.332bc6f0.js";import"./index.db9478fd.js";import{a as te,B as ae}from"./index.9a8bde03.js";var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},re=se;function S(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(a).filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable}))),l.forEach(function(u){ie(e,u,a[u])})}return e}function ie(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var O=function(t,a){var l=S({},t,a.attrs);return c(A,S({},l,{icon:re}),null)};O.displayName="UploadOutlined";O.inheritAttrs=!1;var ne=O;const h=$(),Oe=e=>x.get({url:"/images",params:e}),le=e=>x.post({url:"/images",data:e}),ue=h.apiUrl+h.urlPrefix+"/upload",oe=e=>L(h.apiUrl+h.urlPrefix+":common/images/{id}/url",{id:e});var D=(e=>(e[e.FROM_UNSPECIFIED=0]="FROM_UNSPECIFIED",e[e.FROM_USER=1]="FROM_USER",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(D||{});const de={class:"picutre-drawer-list"},be=T({__name:"PictureDrawer",props:{value:{type:[String,Array]},limit:{type:Number,default:1},images:{type:Array,default(){return[]}}},emits:["success","reload","register","update:value"],setup(e,{emit:t}){const a=e,l=C.TabPane,u={authorization:j()},r=z({activeKey:"1",ids:[],items:[],data:null}),{createMessage:f}=X(),[p,{setDrawerProps:i,closeDrawer:g}]=te(s=>v(this,null,function*(){r.data=s,b()})),R="\u56FE\u5E93\u7BA1\u7406";function B(){return v(this,null,function*(){try{const{limit:s}=a;s>1?t("update:value",r.ids):t("update:value",r.ids.length>0?r.ids[0]:null),i({confirmLoading:!0}),g(),t("success",{data:r.data,ids:r.ids,items:r.items})}finally{i({confirmLoading:!1})}})}function b(){r.ids=[],r.items=[],i({confirmLoading:!1})}function N(s){s.file.status==="done"&&le({id:s.file.response.id,from:D.FROM_USER,disk:"cos"}).then(o=>{t("reload")}).catch(o=>{throw o}),s.file.status!=="uploading"&&(s.file,s.fileList),s.file.status==="done"?f.success(`${s.file.name} file uploaded successfully`):s.file.status==="error"&&f.error(`${s.file.name} file upload failed.`)}function F(s){const{limit:o}=a;if(!!s.id)if(o>1){if(r.ids.indexOf(s.id)!==-1){let d=r.ids.indexOf(s.id);r.ids.splice(d,1),r.items.splice(d,1)}else if(r.ids.length<o)r.ids.push(s.id),r.items.push(w({},s));else if(r.ids.length!==1){f.warn("\u6700\u591A\u9009\u62E9"+o+"\u5F20\u56FE\u7247");return}}else r.ids.indexOf(s.id)!==-1?(r.ids=[],r.items=[]):(r.ids=[s.id],r.items=[s])}function k(s){return s.id&&r.ids.indexOf(s.id)>-1?"pic-box":"pic-default"}return(s,o)=>(y(),_(P,null,[H(s.$slots,"default"),c(n(ae),W(s.$attrs,{onRegister:n(p),showFooter:"",title:R,width:"500px",onVisibleChange:b,onOk:B}),{default:m(()=>[c(n(C),{activeKey:r.activeKey,"onUpdate:activeKey":o[0]||(o[0]=d=>r.activeKey=d)},{default:m(()=>[c(n(l),{key:"1",tab:"\u5168\u90E8"})]),_:1},8,["activeKey"]),c(n(ee),{name:"attachment",action:n(ue),headers:u,showUploadList:!1,onChange:N},{default:m(()=>[c(n(K),null,{default:m(()=>[c(n(ne)),G(" \u4E0A\u4F20\u56FE\u7247 ")]),_:1})]),_:1},8,["action"]),Z("div",de,[(y(!0),_(P,null,q(e.images,d=>(y(),J(n(Y),{key:d.id,src:n(oe)(d.id),width:80,preview:!1,class:Q(k(d)),onClick:ce=>F(d)},null,8,["src","class","onClick"]))),128))])]),_:1},16,["onRegister"])],64))}});export{be as _,oe as i,Oe as l};
