var V=Object.defineProperty,O=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var A=(e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,v=(e,t)=>{for(var n in t||(t={}))x.call(t,n)&&A(e,n,t[n]);if(I)for(var n of I(t))L.call(t,n)&&A(e,n,t[n]);return e},E=(e,t)=>O(e,T(t));var F=(e,t,n)=>new Promise((g,o)=>{var u=r=>{try{s(n.next(r))}catch(i){o(i)}},d=r=>{try{s(n.throw(r))}catch(i){o(i)}},s=r=>r.done?g(r.value):Promise.resolve(r.value).then(u,d);s((n=n.apply(e,t)).next())});import{d$ as b,a as N,e5 as z,s as y,k as _,f as G,av as H,ax as p,o as B,h as C,n as f,y as w,F as k,z as P,j as W,ay as J}from"./index.05f21f62.js";import{I as K}from"./index.4d00782a.js";import{u as Q}from"./index.02c398aa.js";import{B as X}from"./BasicForm.a2791009.js";import{u as Y}from"./useForm.ffed4a20.js";import{l as Z}from"./article.651e645f.js";import{B as ee,b as te}from"./index.519bbcb9.js";import{_ as ne,l as S}from"./PictureDrawer.b95eab52.js";const ae=e=>b.get({url:"/banner/get_all_banner",params:e}),_e=e=>b.get({url:"/banner/admin/banner_all_item",params:e}),we=e=>b.post({url:"/banner/admin/add_banner",data:e}),be=e=>b.post({url:"/banner/admin/edit_banner",data:e}),he=[{title:"\u5E8F\u53F7",dataIndex:"id",width:200},{title:"\u6392\u5E8F",dataIndex:"sort",edit:!0,editable:!0,editComponent:"InputNumber",editComponentProps:()=>({min:0}),width:200},{title:"\u540D\u79F0",dataIndex:"key_word",width:200},{title:"\u5E7F\u544A\u4F4D",dataIndex:"banner_id",format:(e,t)=>t==null?void 0:t.banner.name,width:200},{title:"\u8DF3\u8F6C\u5230",dataIndex:"type",format:(e,t)=>{switch(t.type){case"no_jump":return"\u4E0D\u8DF3\u8F6C";case"article":return"\u6587\u7AE0"}},width:200},{title:"\u7F29\u7565\u56FE",dataIndex:"img",width:180}],De=[{field:"key_word",label:"\u540D\u79F0",component:"Input",colProps:{span:8}}],re=[{field:"key_word",label:"\u5E7F\u544A\u540D\u79F0",required:!0,component:"Input"},{field:"banner_id",label:"\u9009\u62E9\u5E7F\u544A\u4F4D",required:!0,component:"ApiSelect",componentProps:{api:ae,resultField:"items",params:{withRoot:!0},labelField:"name",valueField:"id"},defaultValue:1},{field:"type",label:"\u8DF3\u8F6C\u5230",required:!0,component:"Select",componentProps:{options:[{label:"\u4E0D\u8DF3\u8F6C",value:"no_jump",key:"no_jump"},{label:"\u6587\u7AE0",value:"article",key:"article"}]},defaultValue:"no_jump"},{field:"jump_id",label:"\u8DF3\u8F6C\u9009\u9879",required:({values:e})=>e.type!=="no_jump",ifShow:({values:e})=>e.type!=="no_jump",component:"ApiSelect",componentProps:{api:Z,resultField:"items",labelField:"title",valueField:"id"}},{field:"img_id",label:"\u5E7F\u544A\u56FE\u7247",required:!0,slot:"picDrawer",component:"Input"}],oe=N({name:"AdvertisingModal",components:{Image:K,BasicModal:ee,BasicForm:X,PictureDrawer:ne,BasicButton:z},emits:["success","register"],setup(e,{emit:t}){const[n,{openDrawer:g}]=Q(),o=y(!0),u=y([]),d=y(""),[s,{resetFields:r,setFieldsValue:i,validate:h}]=Y({labelWidth:90,baseColProps:{span:24},schemas:re,showActionButtonGroup:!1}),[m,{setModalProps:c,closeModal:M}]=te(a=>F(this,null,function*(){r(),c({confirmLoading:!1}),o.value=!!(a!=null&&a.isUpdate),u.value=(yield S()).items,_(o)&&(d.value=a.record.id,i(v({},a.record)))})),R=G(()=>_(o)?"\u7F16\u8F91\u5E7F\u544A":"\u65B0\u589E\u5E7F\u544A");function j(a){for(let l=0;l<u.value.length;l++){const D=u.value[l];if(D.id==a)return D.full_url,D.full_url}return""}function $(){return F(this,null,function*(){u.value=(yield S()).items})}function q({ids:a,items:l}){i({img_id:(a==null?void 0:a.length)>0?a[0]:null,img:(l==null?void 0:l.length)>0?l[0]:null})}function U(){return F(this,null,function*(){try{const a=yield h();c({confirmLoading:!0}),M(),t("success",{isUpdate:_(o),values:E(v({},a),{id:_(o)?d.value:void 0})})}finally{c({confirmLoading:!1})}})}return{images:u,registerModal:m,registerForm:s,getTitle:R,handleSubmit:U,registerDrawer:n,openDrawer:g,getImageUrlById:j,handlePictureDrawerRealod:$,handlePictureDrawerSuccess:q}}});function ue(e,t,n,g,o,u){const d=p("Image"),s=p("BasicButton"),r=p("BasicForm"),i=p("BasicModal"),h=p("PictureDrawer");return B(),C(k,null,[f(i,J(e.$attrs,{onRegister:e.registerModal,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:w(()=>[f(r,{onRegister:e.registerForm},{picDrawer:w(({model:m,field:c})=>[m[c]>0?(B(),C(k,{key:0},[f(d,{src:e.getImageUrlById(m[c]),preview:!1},null,8,["src"]),f(s,{onClick:()=>m[c]=0},{default:w(()=>[P("\u5220\u9664")]),_:2},1032,["onClick"])],64)):(B(),W(s,{key:1,onClick:e.openDrawer},{default:w(()=>[P("\u9009\u62E9\u56FE\u7247")]),_:1},8,["onClick"]))]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title","onOk"]),f(h,{images:e.images,onRegister:e.registerDrawer,onReload:e.handlePictureDrawerRealod,onSuccess:e.handlePictureDrawerSuccess},null,8,["images","onRegister","onReload","onSuccess"])],64)}var se=H(oe,[["render",ue]]),ve=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{se as A,we as a,ve as b,he as c,_e as l,De as s,be as u};
