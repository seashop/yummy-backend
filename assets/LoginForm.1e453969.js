var F=(k,f,i)=>new Promise((l,m)=>{var a=r=>{try{c(i.next(r))}catch(u){m(u)}},p=r=>{try{c(i.throw(r))}catch(u){m(u)}},c=r=>r.done?l(r.value):Promise.resolve(r.value).then(a,p);c((i=i.apply(k,f)).next())});import{a as z,I as B,c as M,b as G,r as O,s as _,v as P,f as U,k as e,o as K,h as q,w as b,x as L,n as o,y as s,z as C,t as w,B as E,l as S,C as W,F as j,D as Q}from"./index.05f21f62.js";import{C as H}from"./index.a55a4d9b.js";/* empty css              *//* empty css               */import{u as J,a as X,L as D,_ as Y,b as Z}from"./LoginFormTitle.772b5a5f.js";import{F as I}from"./Form.823f88cb.js";import{C as ee,R as te}from"./index.e2c79e1e.js";import"./Checkbox.1e5d27b2.js";import"./Col.8f679cd2.js";import"./useFlexGapSupport.ed791f76.js";import"./_baseIteratee.94f70879.js";import"./get.ab1579f8.js";import"./useSize.b22e5468.js";const ye=z({__name:"LoginForm",setup(k){const f=ee,i=te,l=I.Item,m=B.Password,{t:a}=M(),{notification:p,createErrorModal:c}=Q(),{prefixCls:r}=G("login"),u=O(),{setLoginState:R,getLoginState:T}=J(),{getFormRules:$}=X(),h=_(),y=_(!1),v=_(!1),d=P({account:"vben",password:"123456"}),{validForm:A}=Z(h),N=U(()=>e(T)===D.LOGIN);function V(){return F(this,null,function*(){var n;const g=yield A();if(!!g)try{y.value=!0;const t=yield u.login({password:g.password,username:g.account,mode:"none"});t&&p.success({message:a("sys.login.loginSuccessTitle"),description:`${a("sys.login.loginSuccessDesc")}: ${t.realName}`,duration:3})}catch(t){const{response:x}=t||{};c({title:a("sys.api.errorTip"),content:((n=x==null?void 0:x.data)==null?void 0:n.message)||t.message||a("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${r}`)||document.body})}finally{y.value=!1}})}return(g,n)=>(K(),q(j,null,[b(o(Y,{class:"enter-x"},null,512),[[L,e(N)]]),b(o(e(I),{class:"p-4 enter-x",model:d,rules:e($),ref_key:"formRef",ref:h,onKeypress:W(V,["enter"])},{default:s(()=>[o(e(l),{name:"account",class:"enter-x"},{default:s(()=>[o(e(B),{size:"large",value:d.account,"onUpdate:value":n[0]||(n[0]=t=>d.account=t),placeholder:e(a)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),o(e(l),{name:"password",class:"enter-x"},{default:s(()=>[o(e(m),{size:"large",visibilityToggle:"",value:d.password,"onUpdate:value":n[1]||(n[1]=t=>d.password=t),placeholder:e(a)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),o(e(i),{class:"enter-x"},{default:s(()=>[o(e(f),{span:12},{default:s(()=>[o(e(l),null,{default:s(()=>[o(e(H),{checked:v.value,"onUpdate:checked":n[2]||(n[2]=t=>v.value=t),size:"small"},{default:s(()=>[C(w(e(a)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),o(e(f),{span:12},{default:s(()=>[o(e(l),{style:{"text-align":"right"}},{default:s(()=>[o(e(E),{type:"link",size:"small",onClick:n[3]||(n[3]=t=>e(R)(e(D).RESET_PASSWORD))},{default:s(()=>[C(w(e(a)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),o(e(l),{class:"enter-x"},{default:s(()=>[o(e(E),{type:"primary",size:"large",block:"",onClick:V,loading:y.value},{default:s(()=>[C(w(e(a)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1}),S("",!0),S("",!0),S("",!0)]),_:1},8,["model","rules","onKeypress"]),[[L,e(N)]])],64))}});export{ye as default};
