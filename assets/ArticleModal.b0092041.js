var V=Object.defineProperty,q=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var I=(e,a,t)=>a in e?V(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,E=(e,a)=>{for(var t in a||(a={}))j.call(a,t)&&I(e,t,a[t]);if(D)for(var t of D(a))L.call(a,t)&&I(e,t,a[t]);return e},b=(e,a)=>q(e,O(a));var h=(e,a,t)=>new Promise((n,o)=>{var r=s=>{try{i(t.next(s))}catch(l){o(l)}},m=s=>{try{i(t.throw(s))}catch(l){o(l)}},i=s=>s.done?n(s.value):Promise.resolve(s.value).then(r,m);i((t=t.apply(e,a)).next())});import{bT as x,D as z,a as N,e5 as G,s as y,k as F,f as W,av as H,ax as f,o as v,h as k,n as g,y as w,F as A,z as S,j as J,ay as K}from"./index.05f21f62.js";import{I as Q}from"./index.4d00782a.js";import{u as X}from"./index.02c398aa.js";import{B as Y}from"./BasicForm.a2791009.js";import{u as Z}from"./useForm.ffed4a20.js";import{S as ee}from"./index.4ad5e6f5.js";import{u as te}from"./useComponentRegister.f9e41cd1.js";import{T as ae}from"./index.74f40530.js";import{s as ue}from"./article.651e645f.js";import{B as oe,b as se}from"./index.519bbcb9.js";import{_ as ne,l as C}from"./PictureDrawer.b95eab52.js";te("Tinymce",ae);const ve=[{title:"\u5E8F\u53F7",dataIndex:"id",width:200},{title:"\u6807\u9898",dataIndex:"title",width:200},{title:"\u7F29\u7565\u56FE",dataIndex:"img",width:180},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_at",width:180},{title:"\u9690\u85CF",dataIndex:"is_hidden",width:180,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),x(ee,{checked:e.is_hidden,loading:e.pendingStatus,onChange(a){e.pendingStatus=!0;const t=!!a,{createMessage:n}=z();ue(e.id,{field:"is_hidden"}).then(o=>{o?(e.is_hidden=t,n.success("\u5DF2\u6210\u529F\u4FEE\u6539\u6587\u7AE0\u72B6\u6001")):n.success("\u4FEE\u6539\u6587\u7AE0\u72B6\u6001\u5931\u8D25")}).catch(()=>{n.error("\u4FEE\u6539\u6587\u7AE0\u72B6\u6001\u5931\u8D25")}).finally(()=>{e.pendingStatus=!1})}}))}],De=[{field:"key_word",label:"\u540D\u79F0",component:"Input",colProps:{span:8}}],re=[{field:"title",label:"\u6807\u9898",required:!0,component:"Input"},{field:"type",label:"\u7C7B\u578B",required:!0,component:"Select",componentProps:{options:[{label:"\u72EC\u7ACB\u6587\u7AE0",value:1,key:1},{label:"\u5C0F\u7A0B\u5E8F\u8DF3\u8F6C",value:2,key:2},{label:"\u516C\u544A",value:3,key:3},{label:"\u6D3B\u52A8",value:4,key:4},{label:"\u4E2A\u4EBA\u4E2D\u5FC3",value:5,key:5}]},defaultValue:1},{field:"img_id",label:"\u7F29\u7565\u56FE",required:!0,slot:"picDrawer",component:"Input"},{field:"content",label:"\u5185\u5BB9",required:!0,component:"Tinymce",componentProps:{showImageUpload:!1},defaultValue:""}],ie=N({name:"AdvertisingModal",components:{Image:Q,BasicModal:oe,BasicForm:Y,PictureDrawer:ne,BasicButton:G},emits:["success","register"],setup(e,{emit:a}){const[t,{openDrawer:n}]=X(),o=y(!0),r=y([]),m=y(""),[i,{resetFields:s,setFieldsValue:l,validate:B}]=Z({labelWidth:90,baseColProps:{span:24},schemas:re,showActionButtonGroup:!1}),[p,{setModalProps:d,closeModal:M}]=se(u=>h(this,null,function*(){s(),d({confirmLoading:!1}),o.value=!!(u!=null&&u.isUpdate),r.value=(yield C()).items,F(o)&&(m.value=u.record.id,l(E({},u.record)))})),P=W(()=>F(o)?"\u7F16\u8F91\u6587\u7AE0":"\u65B0\u589E\u6587\u7AE0");function R(u){for(let c=0;c<r.value.length;c++){const _=r.value[c];if(_.id==u)return _.full_url,_.full_url}return""}function T(){return h(this,null,function*(){r.value=(yield C()).items})}function $({ids:u,items:c}){l({img_id:(u==null?void 0:u.length)>0?u[0]:null,img:(c==null?void 0:c.length)>0?c[0]:null})}function U(){return h(this,null,function*(){try{const u=yield B();d({confirmLoading:!0}),M(),a("success",{isUpdate:F(o),values:b(E({},u),{id:F(o)?m.value:void 0})})}finally{d({confirmLoading:!1})}})}return{images:r,registerModal:p,registerForm:i,getTitle:P,handleSubmit:U,registerDrawer:t,openDrawer:n,getImageUrlById:R,handlePictureDrawerRealod:T,handlePictureDrawerSuccess:$}}});function le(e,a,t,n,o,r){const m=f("Image"),i=f("BasicButton"),s=f("BasicForm"),l=f("BasicModal"),B=f("PictureDrawer");return v(),k(A,null,[g(l,K(e.$attrs,{onRegister:e.registerModal,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:w(()=>[g(s,{onRegister:e.registerForm},{picDrawer:w(({model:p,field:d})=>[p[d]>0?(v(),k(A,{key:0},[g(m,{src:e.getImageUrlById(p[d]),preview:!1,width:80},null,8,["src"]),g(i,{onClick:()=>p[d]=0},{default:w(()=>[S("\u5220\u9664")]),_:2},1032,["onClick"])],64)):(v(),J(i,{key:1,onClick:e.openDrawer},{default:w(()=>[S("\u9009\u62E9\u56FE\u7247")]),_:1},8,["onClick"]))]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title","onOk"]),g(B,{images:e.images,onRegister:e.registerDrawer,onReload:e.handlePictureDrawerRealod,onSuccess:e.handlePictureDrawerSuccess},null,8,["images","onRegister","onReload","onSuccess"])],64)}var ce=H(ie,[["render",le]]),Ie=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{ce as A,Ie as a,ve as c,De as s};
